{"version":3,"sources":["../src/Snowfall.tsx"],"names":["defaultConfig","color","Snowfall","snowflakeCount","style","config","mergedStyle","canvasRef","canvasSize","animationFrame","lastUpdate","Date","now","mergedConfig","snowflakes","updateCanvasRef","element","current","render","framesPassed","canvas","forEach","snowflake","update","ctx","getContext","clearRect","offsetWidth","offsetHeight","draw","loop","msPassed","targetFrameTime","requestAnimationFrame","cancelAnimationFrame","height","width"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef } from 'react'\nimport { targetFrameTime } from './config'\nimport { useComponentSize, useSnowfallStyle, useSnowflakes } from './hooks'\nimport { SnowflakeConfig } from './Snowflake';\n\nexport interface SnowfallProps {\n  config?: SnowflakeConfig\n  snowflakeCount?: number\n  style?: React.CSSProperties\n}\n\nconst defaultConfig = {\n  color: '#dee4fd'\n};\n\nconst Snowfall = ({ snowflakeCount = 150, style, config = {} }: SnowfallProps = {}) => {\n  const mergedStyle = useSnowfallStyle(style)\n\n  const canvasRef = useRef<HTMLCanvasElement>()\n  const canvasSize = useComponentSize(canvasRef)\n  const animationFrame = useRef(0)\n\n  const lastUpdate = useRef(Date.now())\n  const mergedConfig = useMemo(() => ({ ...defaultConfig, ...config }), [config]);\n  const snowflakes = useSnowflakes(canvasRef, snowflakeCount, mergedConfig)\n\n  const updateCanvasRef = (element: HTMLCanvasElement) => {\n    canvasRef.current = element\n  }\n\n  const render = useCallback(\n    (framesPassed: number = 1) => {\n      const canvas = canvasRef.current\n      if (canvas) {\n        // Update the positions of the snowflakes\n        snowflakes.forEach(snowflake => snowflake.update(canvas, framesPassed))\n\n        // Render them if the canvas is available\n        const ctx = canvas.getContext('2d')\n        if (ctx) {\n          ctx.clearRect(0, 0, canvas.offsetWidth, canvas.offsetHeight)\n\n          snowflakes.forEach(snowflake => snowflake.draw(canvas, ctx))\n        }\n      }\n    },\n    [snowflakes],\n  )\n\n  const loop = useCallback(() => {\n    // Update based on time passed so that a slow frame rate won't slow down the snowflake\n    const now = Date.now()\n    const msPassed = Date.now() - lastUpdate.current\n    lastUpdate.current = now\n\n    // Frames that would have passed if running at 60 fps\n    const framesPassed = msPassed / targetFrameTime\n\n    render(framesPassed)\n\n    animationFrame.current = requestAnimationFrame(loop)\n  }, [render])\n\n  useEffect(() => {\n    loop()\n    return () => cancelAnimationFrame(animationFrame.current)\n  }, [loop])\n\n  return <canvas ref={updateCanvasRef} height={canvasSize.height} width={canvasSize.width} style={mergedStyle} />\n}\n\nexport default Snowfall\n"],"file":"Snowfall.js"}