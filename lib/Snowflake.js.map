{"version":3,"sources":["../src/Snowflake.ts"],"names":["defaultConfig","color","radius","speed","wind","changeFrequency","Snowflake","canvas","config","inputCtx","ctx","getContext","beginPath","arc","params","x","y","Math","PI","fillStyle","fullConfig","closePath","fill","framesPassed","nextWind","nextSpeed","offsetWidth","offsetHeight","framesSinceLastUpdate","updateTargetParams","random","translate"],"mappings":"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","sourcesContent":["import { lerp, random } from './utils'\n\nexport interface SnowflakeProps {\n  color: string\n  radius: [number, number]\n  speed: [number, number]\n  wind: [number, number]\n  changeFrequency: number\n}\n\nexport type SnowflakeConfig = Partial<SnowflakeProps>\n\nconst defaultConfig: SnowflakeProps = {\n  color: '#dee4fd',\n  radius: [0.5, 3.0],\n  speed: [1, 3],\n  wind: [-0.5, 2],\n  changeFrequency: 200,\n}\n\ninterface SnowflakeParams {\n  x: number\n  y: number\n  radius: number\n  speed: number\n  wind: number\n  nextSpeed: number\n  nextWind: number\n}\n\n/** An individual snowflake that will update it's location every call to `draw` */\nclass Snowflake {\n  public config: SnowflakeConfig\n  private params: SnowflakeParams\n  private framesSinceLastUpdate: number\n\n  public constructor(canvas: HTMLCanvasElement, config: SnowflakeConfig = {}) {\n    // Set custom config\n    this.config = config\n\n    // Setting initial parameters\n    const { radius, wind, speed } = this.fullConfig\n\n    this.params = {\n      x: random(0, canvas.offsetWidth),\n      y: random(-canvas.offsetHeight, 0),\n      radius: random(...radius),\n      speed: random(...speed),\n      wind: random(...wind),\n      nextSpeed: random(...wind),\n      nextWind: random(...speed),\n    }\n\n    this.framesSinceLastUpdate = 0\n  }\n\n  private get fullConfig() {\n    return {\n      ...defaultConfig,\n      ...this.config,\n    }\n  }\n\n  public draw = (canvas: HTMLCanvasElement, inputCtx?: CanvasRenderingContext2D) => {\n    const ctx = inputCtx || canvas.getContext('2d')\n    if (ctx) {\n      ctx.beginPath()\n      ctx.arc(this.params.x, this.params.y, this.params.radius, 0, 2 * Math.PI)\n      ctx.fillStyle = this.fullConfig.color\n      ctx.closePath()\n      ctx.fill()\n    }\n  }\n\n  private translate = (canvas: HTMLCanvasElement, framesPassed: number = 1) => {\n    const { x, y, wind, speed, nextWind, nextSpeed } = this.params\n\n    // Update current location, wrapping around if going off the canvas\n    this.params.x = (x + wind * framesPassed) % canvas.offsetWidth\n    this.params.y = (y + speed * framesPassed) % canvas.offsetHeight\n\n    // Update the wind and speed towards the desired values\n    this.params.speed = lerp(speed, nextSpeed, 0.01)\n    this.params.wind = lerp(wind, nextWind, 0.01)\n\n    if (this.framesSinceLastUpdate++ > this.fullConfig.changeFrequency) {\n      this.updateTargetParams()\n      this.framesSinceLastUpdate = 0\n    }\n  }\n\n  private updateTargetParams = () => {\n    this.params.nextSpeed = random(...this.fullConfig.speed)\n    this.params.nextWind = random(...this.fullConfig.wind)\n  }\n\n  public update = (canvas: HTMLCanvasElement, framesPassed?: number) => {\n    this.translate(canvas, framesPassed)\n  }\n}\n\nexport default Snowflake\n"],"file":"Snowflake.js"}