{"version":3,"sources":["../src/Snowfall.tsx"],"names":["defaultConfig","color","Snowfall","snowflakeCount","style","config","mergedStyle","canvasRef","canvasSize","animationFrame","lastUpdate","Date","now","speed","wind","radius","changeFrequency","mergedConfig","snowflakes","updateCanvasRef","element","current","render","framesPassed","canvas","forEach","snowflake","update","ctx","getContext","clearRect","offsetWidth","offsetHeight","draw","loop","msPassed","targetFrameTime","requestAnimationFrame","cancelAnimationFrame","height","width"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;;;;;AAQA,IAAMA,aAAa,GAAG;AACpBC,EAAAA,KAAK,EAAE;AADa,CAAtB;;AAIA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,GAAoE;AAAA,iFAAP,EAAO;;AAAA,iCAAjEC,cAAiE;AAAA,MAAjEA,cAAiE,oCAAhD,GAAgD;AAAA,MAA3CC,KAA2C,QAA3CA,KAA2C;AAAA,MAAjCC,MAAiC;;AACnF,MAAMC,WAAW,GAAG,6BAAiBF,KAAjB,CAApB;AAEA,MAAMG,SAAS,GAAG,oBAAlB;AACA,MAAMC,UAAU,GAAG,6BAAiBD,SAAjB,CAAnB;AACA,MAAME,cAAc,GAAG,mBAAO,CAAP,CAAvB;AAEA,MAAMC,UAAU,GAAG,mBAAOC,IAAI,CAACC,GAAL,EAAP,CAAnB;AAPmF,MAQ3EX,KAR2E,GAQ3BI,MAR2B,CAQ3EJ,KAR2E;AAAA,MAQpEY,KARoE,GAQ3BR,MAR2B,CAQpEQ,KARoE;AAAA,MAQ7DC,IAR6D,GAQ3BT,MAR2B,CAQ7DS,IAR6D;AAAA,MAQvDC,MARuD,GAQ3BV,MAR2B,CAQvDU,MARuD;AAAA,MAQ/CC,eAR+C,GAQ3BX,MAR2B,CAQ/CW,eAR+C;AASnF,MAAMC,YAAY,GAAG,oBAAQ;AAAA,6BAAYjB,aAAZ;AAA2BC,MAAAA,KAAK,EAALA,KAA3B;AAAkCY,MAAAA,KAAK,EAALA,KAAlC;AAAyCC,MAAAA,IAAI,EAAJA,IAAzC;AAA+CC,MAAAA,MAAM,EAANA,MAA/C;AAAuDC,MAAAA,eAAe,EAAfA;AAAvD;AAAA,GAAR,EAAmF,CACtGf,KADsG,EAEtGY,KAFsG,EAGtGC,IAHsG,EAItGC,MAJsG,EAKtGC,eALsG,CAAnF,CAArB;AAOA,MAAME,UAAU,GAAG,0BAAcX,SAAd,EAAyBJ,cAAzB,EAAyCc,YAAzC,CAAnB;;AAEA,MAAME,eAAe,GAAG,SAAlBA,eAAkB,CAACC,OAAD,EAAgC;AACtDb,IAAAA,SAAS,CAACc,OAAV,GAAoBD,OAApB;AACD,GAFD;;AAIA,MAAME,MAAM,GAAG,wBACb,YAA8B;AAAA,QAA7BC,YAA6B,uEAAN,CAAM;AAC5B,QAAMC,MAAM,GAAGjB,SAAS,CAACc,OAAzB;;AACA,QAAIG,MAAJ,EAAY;AACV;AACAN,MAAAA,UAAU,CAACO,OAAX,CAAmB,UAAAC,SAAS;AAAA,eAAIA,SAAS,CAACC,MAAV,CAAiBH,MAAjB,EAAyBD,YAAzB,CAAJ;AAAA,OAA5B,EAFU,CAIV;;AACA,UAAMK,GAAG,GAAGJ,MAAM,CAACK,UAAP,CAAkB,IAAlB,CAAZ;;AACA,UAAID,GAAJ,EAAS;AACPA,QAAAA,GAAG,CAACE,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoBN,MAAM,CAACO,WAA3B,EAAwCP,MAAM,CAACQ,YAA/C;AAEAd,QAAAA,UAAU,CAACO,OAAX,CAAmB,UAAAC,SAAS;AAAA,iBAAIA,SAAS,CAACO,IAAV,CAAeT,MAAf,EAAuBI,GAAvB,CAAJ;AAAA,SAA5B;AACD;AACF;AACF,GAfY,EAgBb,CAACV,UAAD,CAhBa,CAAf;AAmBA,MAAMgB,IAAI,GAAG,wBAAY,YAAM;AAC7B;AACA,QAAMtB,GAAG,GAAGD,IAAI,CAACC,GAAL,EAAZ;AACA,QAAMuB,QAAQ,GAAGxB,IAAI,CAACC,GAAL,KAAaF,UAAU,CAACW,OAAzC;AACAX,IAAAA,UAAU,CAACW,OAAX,GAAqBT,GAArB,CAJ6B,CAM7B;;AACA,QAAMW,YAAY,GAAGY,QAAQ,GAAGC,uBAAhC;AAEAd,IAAAA,MAAM,CAACC,YAAD,CAAN;AAEAd,IAAAA,cAAc,CAACY,OAAf,GAAyBgB,qBAAqB,CAACH,IAAD,CAA9C;AACD,GAZY,EAYV,CAACZ,MAAD,CAZU,CAAb;AAcA,wBAAU,YAAM;AACdY,IAAAA,IAAI;AACJ,WAAO;AAAA,aAAMI,oBAAoB,CAAC7B,cAAc,CAACY,OAAhB,CAA1B;AAAA,KAAP;AACD,GAHD,EAGG,CAACa,IAAD,CAHH;AAKA,SAAO;AAAQ,IAAA,GAAG,EAAEf,eAAb;AAA8B,IAAA,MAAM,EAAEX,UAAU,CAAC+B,MAAjD;AAAyD,IAAA,KAAK,EAAE/B,UAAU,CAACgC,KAA3E;AAAkF,IAAA,KAAK,EAAElC;AAAzF,IAAP;AACD,CA7DD;;eA+DeJ,Q","sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef } from 'react'\nimport { targetFrameTime } from './config'\nimport { useComponentSize, useSnowfallStyle, useSnowflakes } from './hooks'\nimport { SnowflakeConfig } from './Snowflake'\n\nexport interface SnowfallProps extends SnowflakeConfig {\n  snowflakeCount?: number\n  style?: React.CSSProperties\n}\n\nconst defaultConfig = {\n  color: '#dee4fd',\n}\n\nconst Snowfall = ({ snowflakeCount = 150, style, ...config }: SnowfallProps = {}) => {\n  const mergedStyle = useSnowfallStyle(style)\n\n  const canvasRef = useRef<HTMLCanvasElement>()\n  const canvasSize = useComponentSize(canvasRef)\n  const animationFrame = useRef(0)\n\n  const lastUpdate = useRef(Date.now())\n  const { color, speed, wind, radius, changeFrequency } = config\n  const mergedConfig = useMemo(() => ({ ...defaultConfig, color, speed, wind, radius, changeFrequency }), [\n    color,\n    speed,\n    wind,\n    radius,\n    changeFrequency,\n  ])\n  const snowflakes = useSnowflakes(canvasRef, snowflakeCount, mergedConfig)\n\n  const updateCanvasRef = (element: HTMLCanvasElement) => {\n    canvasRef.current = element\n  }\n\n  const render = useCallback(\n    (framesPassed: number = 1) => {\n      const canvas = canvasRef.current\n      if (canvas) {\n        // Update the positions of the snowflakes\n        snowflakes.forEach(snowflake => snowflake.update(canvas, framesPassed))\n\n        // Render them if the canvas is available\n        const ctx = canvas.getContext('2d')\n        if (ctx) {\n          ctx.clearRect(0, 0, canvas.offsetWidth, canvas.offsetHeight)\n\n          snowflakes.forEach(snowflake => snowflake.draw(canvas, ctx))\n        }\n      }\n    },\n    [snowflakes],\n  )\n\n  const loop = useCallback(() => {\n    // Update based on time passed so that a slow frame rate won't slow down the snowflake\n    const now = Date.now()\n    const msPassed = Date.now() - lastUpdate.current\n    lastUpdate.current = now\n\n    // Frames that would have passed if running at 60 fps\n    const framesPassed = msPassed / targetFrameTime\n\n    render(framesPassed)\n\n    animationFrame.current = requestAnimationFrame(loop)\n  }, [render])\n\n  useEffect(() => {\n    loop()\n    return () => cancelAnimationFrame(animationFrame.current)\n  }, [loop])\n\n  return <canvas ref={updateCanvasRef} height={canvasSize.height} width={canvasSize.width} style={mergedStyle} />\n}\n\nexport default Snowfall\n"],"file":"Snowfall.js"}